## Vite 进度条插件文档

### 概述

Vite 进度条插件是一个为 Vite 构建过程提供可视化进度反馈的工具。它通过显示进度条，帮助开发者实时了解构建进程的进展。此外，插件利用缓存机制来优化连续构建的性能，特别适用于大型项目。

### 主要特性

1. **可配置的进度条**：插件允许用户自定义进度条的总刻度、宽度、完成/未完成部分的字符以及显示格式。
2. **缓存机制**：插件能够缓存转换和代码块的计数，提高连续构建的效率。
3. **准确的进度反馈**：根据实时的文件转换和代码块生成情况更新进度条。
4. **简洁的输出**：在构建过程中，插件会减少不必要的日志输出，使得关键信息更加突出。

### 工作原理

#### 初始化

当 Vite 启动构建流程时，插件首先检查是否存在缓存数据。如果存在，它将使用这些数据来估算进度条的初始状态。否则，插件会扫描源代码目录以计算需要处理的文件数量。

#### 进度条更新

在构建过程中，插件在两个关键阶段更新进度条：

1. **文件转换（transform 钩子）**：每次文件被转换时，插件更新进度条，反映转换进度。
2. **代码块生成（renderChunk 钩子）**：在每个代码块被渲染时，插件同样更新进度条，展示代码块处理的进展。

#### 缓存更新

在构建完成后，插件会更新缓存数据，记录此次构建的转换次数和代码块数量，以便下次构建时使用。

### 使用指南

要使用这个插件，您需要将其添加到 Vite 配置文件中。以下是一个基本的配置示例：

```javascript
import ViteProgressBar from 'vite-plugin-progress-bar';

export default {
  plugins: [
    ViteProgressBar({
      total: 100, // 可选，进度条的总刻度，默认为 100
      format: '[:bar] :percent', // 可选，自定义进度条格式
    })
  ]
}
```

### 结论

Vite 进度条插件是一个实用的工具，能有效提升开发体验，尤其在大型项目中。通过可视化的进度反馈和智能缓存机制，它不仅提供了构建过程的实时反馈，也优化了连续构建的性能。
